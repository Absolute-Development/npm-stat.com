/**!
 * (c) 2012 Paul Vorbach.
 *
 * MIT License (http://vorb.de/license/mit.html)
 */(function(){function e(e){var t=(new RegExp(e+"="+"(.+?)(&|$)")).exec(location.search);return t===null?null:t[1]}function t(e,t,n){return new Highcharts.Chart({chart:{renderTo:e,zoomType:"x",type:"column"},title:{text:t,style:{color:"#000000"}},subtitle:{text:typeof document.ontouchstart=="undefined"?"Click and drag in the plot to zoom in":"Drag your finger over the plot to zoom in",style:{color:"#000000"}},exporting:{enableImages:!0},credits:{enabled:!1},xAxis:{type:"datetime",maxZoom:12096e5,lineColor:"#000000",title:{text:"Date",style:{color:"#000000"}}},yAxis:{min:0,startOnTick:!1,showFirstLabel:!1,title:{text:"Downloads",style:{color:"#000000"}}},tooltip:{shared:!0},legend:{enabled:!1},plotOptions:{column:{color:"#AA0000"}},series:[{name:"Downloads",data:n}]})}function r(e){var t=[],n=e.rows,r=new Date(n[0].key[1]);for(var i in n)r=new Date(n[i].key[1]),t.push([r.getTime(),n[i].value]);return t}function i(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)}function o(e){var t=[],n=i(new Date(e[0][0])),r=0,s,o;for(var u in e)s=e[u],o=new Date(s[0]),n!=i(o)?(t.push([o.getTime(),r]),r=s[1],n=i(o)):r+=s[1];return t}function u(e){var t=[],n=(new Date(e[0][0])).getMonth(),r=0,i,s;for(var o in e)i=e[o],s=new Date(i[0]),n!=s.getMonth()?(t.push({x:(new Date(s.getFullYear(),s.getMonth(),1)).getTime(),y:r}),r=i[1],n=s.getMonth()):r+=i[1];return t}$(document).ready(function(){var n,i,s,a=e("package");a===null&&(a="npm"),$("h2").html('Download statistics for <input type="search" name="package" size="18" value="'+a+'"> <input type="submit" value="Show charts">'),url='http://isaacs.iriscouch.com/downloads/_design/app/_view/pkg?group_level=3&start_key=["'+a+'"]&end_key=["'+a+'",{}]',$.ajax({url:url,dataType:"jsonp",success:function(e){var n=r(e);t("days","Downloads per day",n);var i=o(n);t("weeks","Downloads per week",i);var s=u(n);t("months","Downloads per month",s)},error:function(){alert("Could not receive statistical data.")}})});var n=864e5,s=3*n}).call();